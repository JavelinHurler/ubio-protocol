{
    "description": "Allows automating airplane tickets booking and collecting related information.",
    "inputs": {
        "url": { "$ref": "#Generic.URL" },
        "flight": { "$ref": "#FlightBooking.Flight" },
        "account": { "$ref": "#Generic.Account" },
        "passengers": { "$ref": "#FlightBooking.Passengers" },
        "payment": { "$ref": "#Generic.Payment" },
        "finalPriceConsent": {
            "$ref": "#Generic.PriceConsent",
            "description": "Client's consent for final price. Must exactly match the <code>finalPrice</code> object."
        }
    },
    "outputs": {
        "finalPrice": {
            "description": "Emitted immediately before placing order, when final price is available.",
            "$ref": "#Generic.PriceConsent"
        },
        "bookingConfirmation": { "$ref": "#FlightBooking.BookingConfirmation" }
    },
    "types": {
        "Flight": {
            "type": "object",
            "properties": {
                "from": { "$ref": "#FlightBooking.DatePlace" },
                "to": { "$ref": "#FlightBooking.DatePlace" },
                "return": { "$ref": "#FlightBooking.ReturnFlight" },
                "price": { "$ref": "#Generic.Price" },
                "cabinClass": {
                    "type": "string"
                }
            },
            "required": [
                "from",
                "to",
                "price"
            ],
            "additionalProperties": true
        },
        "ReturnFlight": {
            "type": "object",
            "properties": {
                "from": { "$ref": "#FlightBooking.DatePlace" },
                "to": { "$ref": "#FlightBooking.DatePlace" }
            },
            "required": [
                "from",
                "to"
            ]
        },
        "DatePlace": {
            "type": "object",
            "properties": {
                "countryCode": {
                    "$ref": "#Generic.CountryCode"
                },
                "dateTime": {
                    "type": "string",
                    "pattern": "^20[0-9]{2}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-3][0-9]) [012][0-9]:[0-5][0-9]$",
                    "description": "Date and time of flight (airport local time)"
                },
                "airportCode": {
                    "type": "string",
                    "minLength": 3,
                    "maxLength": 3,
                    "pattern": "^[A-Z]{3}$",
                    "description": "International Air Transport Association airport code"
                }
            },
            "required": [
                "dateTime",
                "airportCode"
            ]
        },
        "Passengers": {
            "type": "array",
            "minItems": 1,
            "maxItems": 9,
            "items": { "$ref": "#FlightBooking.Passenger" }
        },
        "Passenger": {
            "type": "object",
            "properties": {
                "title": {
                    "enum": [
                        "mr",
                        "miss",
                        "ms",
                        "mrs"
                    ]
                },
                "firstName": {
                    "type": "string"
                },
                "lastName": {
                    "type": "string"
                },
                "middleName": {
                    "type": "string",
                    "default": ""
                },
                "dateOfBirth": {
                    "type": "string",
                    "format": "date"
                },
                "addAdditionalLuggage": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 3,
                    "default": 0
                },
                "id": {
                    "type": "object",
                    "properties": {
                        "type": {
                            "type": "string"
                        },
                        "number": {
                            "type": "string"
                        },
                        "expDate": {
                            "type": "string",
                            "format": "date"
                        },
                        "countryCode": {
                            "$ref": "#Generic.CountryCode"
                        }
                    }
                }
            },
            "required": [
                "title",
                "firstName",
                "lastName",
                "dateOfBirth",
                "hasHoldLuggage"
            ]
        },
        "BookingConfirmation": {
            "description": "Emitted on \"Booking success\" page.",
            "properties": {
                "bookingReference": {
                    "type": "string",
                    "description": "Booking reference grabbed from the page."
                },
                "message": {
                    "type": "string",
                    "description": "Message about successful booking."
                },
                "price": {
                    "$ref": "#Generic.Price",
                    "description": "Price, if found on the successful booking page."
                }
            },
            "additionalProperties": false,
            "required": [
                "bookingReference"
            ]
        }
    }
}
